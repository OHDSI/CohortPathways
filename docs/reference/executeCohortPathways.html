<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Execute cohort pathway analysis. — executeCohortPathways • CohortPathways</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Execute cohort pathway analysis. — executeCohortPathways"><meta property="og:description" content="This function reproduces the logic behind &quot;Cohort Pathways&quot; (sometimes referred to as
&quot;Treatment Pathways&quot;) as defined in ATLAS. A pathway is the sequence of events that occur
after a cohort entry, often used to compare or visualize patients' treatment patterns.
The function takes a set of target cohorts (the index cohorts) and event cohorts (the
“steps” in the pathway) and computes the frequency and order in which these events occur."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CohortPathways</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/IntroductionToCohortPathways.html">Introduction to CohortPathways</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://ohdsi.github.io/Hades" class="external-link"><img src='https://ohdsi.github.io/Hades/images/hadesMini.png' width=80 height=17 style='vertical-align: top;'></a>
</li>
<li>
  <a href="https://github.com/OHDSI/CohortPathways/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Execute cohort pathway analysis.</h1>
    <small class="dont-index">Source: <a href="https://github.com/OHDSI/CohortPathways/blob/HEAD/R/ExecuteCohortPathways.R" class="external-link"><code>R/ExecuteCohortPathways.R</code></a></small>
    <div class="hidden name"><code>executeCohortPathways.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function reproduces the logic behind "Cohort Pathways" (sometimes referred to as
"Treatment Pathways") as defined in ATLAS. A <em>pathway</em> is the sequence of events that occur
after a cohort entry, often used to compare or visualize patients' treatment patterns.
The function takes a set of target cohorts (the index cohorts) and event cohorts (the
“steps” in the pathway) and computes the frequency and order in which these events occur.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">executeCohortPathways</span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  connection <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">cohortDatabaseSchema</span>,</span>
<span>  cohortTableName <span class="op">=</span> <span class="st">"cohort"</span>,</span>
<span>  tempEmulationSchema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"sqlRenderTempEmulationSchema"</span><span class="op">)</span>,</span>
<span>  <span class="va">targetCohortIds</span>,</span>
<span>  <span class="va">eventCohortIds</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  allowRepeats <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  maxDepth <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  collapseWindow <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-connectiondetails">connectionDetails<a class="anchor" aria-label="anchor" href="#arg-connectiondetails"></a></dt>
<dd><p>An object of type <code><a href="https://ohdsi.github.io/DatabaseConnector/reference/createConnectionDetails.html" class="external-link">createConnectionDetails</a></code>
(from the <span class="pkg">DatabaseConnector</span> package) providing the details
to connect to the database. If <code>NULL</code>, then <code>connection</code>
must be provided.</p></dd>


<dt id="arg-connection">connection<a class="anchor" aria-label="anchor" href="#arg-connection"></a></dt>
<dd><p>An existing database connection (as created by
<code><a href="https://ohdsi.github.io/DatabaseConnector/reference/connect.html" class="external-link">connect</a></code>). If <code>NULL</code>, a new
connection will be established using <code>connectionDetails</code> at
the start of the function, and closed upon completion.</p></dd>


<dt id="arg-cohortdatabaseschema">cohortDatabaseSchema<a class="anchor" aria-label="anchor" href="#arg-cohortdatabaseschema"></a></dt>
<dd><p>Schema where the target and event cohorts are stored.
For SQL Server, this should include both the database and
schema name (e.g., "mydatabase.dbo").</p></dd>


<dt id="arg-cohorttablename">cohortTableName<a class="anchor" aria-label="anchor" href="#arg-cohorttablename"></a></dt>
<dd><p>Name of the table containing your cohorts (default = "cohort").</p></dd>


<dt id="arg-tempemulationschema">tempEmulationSchema<a class="anchor" aria-label="anchor" href="#arg-tempemulationschema"></a></dt>
<dd><p>For databases without true temp table support (e.g., Oracle),
specify a schema where you have write privileges to emulate temp
tables.</p></dd>


<dt id="arg-targetcohortids">targetCohortIds<a class="anchor" aria-label="anchor" href="#arg-targetcohortids"></a></dt>
<dd><p>Integer vector of cohort definition IDs representing one or more
<em>target</em> cohorts (the index populations whose pathways you want
to explore).</p></dd>


<dt id="arg-eventcohortids">eventCohortIds<a class="anchor" aria-label="anchor" href="#arg-eventcohortids"></a></dt>
<dd><p>Integer vector of cohort definition IDs representing one or more
<em>event</em> cohorts (the steps in the pathways, e.g., treatments or
clinical events).</p></dd>


<dt id="arg-mincellcount">minCellCount<a class="anchor" aria-label="anchor" href="#arg-mincellcount"></a></dt>
<dd><p>The minimum cell count to display (default = 5). Any group or count
below this threshold should be redacted or masked if you're following
a strict privacy policy.</p></dd>


<dt id="arg-allowrepeats">allowRepeats<a class="anchor" aria-label="anchor" href="#arg-allowrepeats"></a></dt>
<dd><p>Boolean; if <code>TRUE</code>, an event cohort can reappear multiple times
in the same patient's pathway sequence (default = <code>FALSE</code>).</p></dd>


<dt id="arg-maxdepth">maxDepth<a class="anchor" aria-label="anchor" href="#arg-maxdepth"></a></dt>
<dd><p>Maximum number of steps in any pathway (default = 5). Pathways
longer than this threshold are truncated.</p></dd>


<dt id="arg-collapsewindow">collapseWindow<a class="anchor" aria-label="anchor" href="#arg-collapsewindow"></a></dt>
<dd><p>An integer indicating the number of days within which events are
considered the same "step" (default = 30 days). This window
effectively groups closely occurring events to reduce spurious
variability.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A named list of data frames capturing key pathway results:</p><dl><dt><code>pathwayAnalysisStatsData</code></dt>
<dd><p>High-level summary statistics about the
number of people in each target cohort
and the distribution of events.</p></dd>

<dt><code>pathwaysAnalysisPathsData</code></dt>
<dd><p>Rows describing each distinct pathway
(sequence of events) observed,
along with counts of persons following each path.</p></dd>

<dt><code>pathwaysAnalysisEventsData</code></dt>
<dd><p>Detailed event-level information, allowing
you to see how each event fits into a given path.</p></dd>

<dt><code>pathwayAnalysisCodesData</code></dt>
<dd><p>Mapping of event cohort IDs to pathway "codes"
for easy interpretation of combinatorial steps.</p></dd>

<dt><code>pathwaycomboIds, pathwayAnalysisCodesLong, isCombo</code></dt>
<dd><p>Additional helper
tables describing
combos of events.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>Overview</strong>
Cohort Pathways are commonly used to visualize how patients move through different treatments
or events over time. Within ATLAS, these pathways are depicted as “sunburst” diagrams and
flow charts. This function provides a programmatic way to replicate that logic outside of ATLAS,
especially useful when you need to run a pathway analysis in a fully scripted R environment.</p>
<p><strong>Key Steps</strong></p><ol><li><p><strong>Identify Cohorts</strong>: You must already have <em>target</em> and <em>event</em> cohorts instantiated in
your results schema (i.e., the cohorts exist in the <code>cohortTableName</code> table).</p></li>
<li><p><strong>Specify Pathway Parameters</strong>: Options such as <code>allowRepeats</code>, <code>collapseWindow</code>,
and <code>maxDepth</code> control how the event sequences are aggregated:</p><ul><li><p><code>allowRepeats</code>: If <code>TRUE</code>, an event cohort can appear more than once at
different time points in the pathway sequence for the same person.</p></li>
<li><p><code>collapseWindow</code>: Events that occur within this many days of each other
(default = 30 days) will be considered part of the same step, reducing the “noise” of very
frequent transitions.</p></li>
<li><p><code>maxDepth</code>: The maximum length of a pathway (default = 5 steps). Longer
sequences are truncated to keep the analysis and visualization more interpretable.</p></li>
</ul></li>
<li><p><strong>Analyze</strong>: The function creates internal temporary tables (or uses your specified
<code>tempEmulationSchema</code> if necessary) to calculate how many people experience
each distinct pathway. It then returns several data frames capturing:</p><ul><li><p><code>pathwayAnalysisStatsData</code>: Summary statistics by target cohort, including
total counts and the distribution of event occurrences.</p></li>
<li><p><code>pathwaysAnalysisPathsData</code>: The distinct sequences (paths) observed,
with counts of how many persons followed each sequence.</p></li>
<li><p><code>pathwaysAnalysisEventsData</code>: A more granular breakdown of how events
contribute to different pathway steps.</p></li>
<li><p><code>pathwayAnalysisCodesData</code> and related tables: Helper mappings and indices
that translate event cohorts into pathway “codes.”</p></li>
</ul></li>
</ol><p><strong>Cell Count Restrictions</strong>
The argument <code>minCellCount</code> allows you to enforce a minimum cell count, consistent with
privacy rules. Any group or count below <code>minCellCount</code> can be masked or handled downstream
according to your organization’s policies.</p>
<p><strong>Reference</strong></p><ul><li><p><em>The Book of OHDSI</em> (Chapter: Characterization, Section: Cohort Pathways in ATLAS)</p></li>
<li><p>OHDSI Forums:
<a href="https://forums.ohdsi.org/t/cohort-pathways-in-atlas-faq/9511/2" class="external-link">https://forums.ohdsi.org/t/cohort-pathways-in-atlas-faq/9511/2</a>
<a href="https://forums.ohdsi.org/t/reproducing-a-treatment-pathway-study-atlas-json-files/9450" class="external-link">https://forums.ohdsi.org/t/reproducing-a-treatment-pathway-study-atlas-json-files/9450</a></p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Example: Execute a pathway analysis for two target cohorts and three event cohorts.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1) Create connection details or use an existing connection.</span></span></span>
<span class="r-in"><span><span class="va">connDetails</span> <span class="op">&lt;-</span> <span class="fu">DatabaseConnector</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/DatabaseConnector/reference/createConnectionDetails.html" class="external-link">createConnectionDetails</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  dbms <span class="op">=</span> <span class="st">"postgresql"</span>,</span></span>
<span class="r-in"><span>  server <span class="op">=</span> <span class="st">"myserver/mydb"</span>,</span></span>
<span class="r-in"><span>  user <span class="op">=</span> <span class="st">"someuser"</span>,</span></span>
<span class="r-in"><span>  password <span class="op">=</span> <span class="st">"DontSharePasswords"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2) Run the function</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">executeCohortPathways</span><span class="op">(</span></span></span>
<span class="r-in"><span>  connectionDetails <span class="op">=</span> <span class="va">connDetails</span>,</span></span>
<span class="r-in"><span>  cohortDatabaseSchema <span class="op">=</span> <span class="st">"my_results_schema"</span>,</span></span>
<span class="r-in"><span>  cohortTableName <span class="op">=</span> <span class="st">"my_cohort"</span>,</span></span>
<span class="r-in"><span>  targetCohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123</span>, <span class="fl">456</span><span class="op">)</span>, <span class="co"># e.g., 'diabetes' and 'hypertension' cohorts</span></span></span>
<span class="r-in"><span>  eventCohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">789</span>, <span class="fl">1011</span>, <span class="fl">1213</span><span class="op">)</span>, <span class="co"># e.g., 'metformin', 'insulin', 'ace_inhibitors'</span></span></span>
<span class="r-in"><span>  allowRepeats <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  maxDepth <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  collapseWindow <span class="op">=</span> <span class="fl">14</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3) Inspect the returned data frames for pathway summaries and details</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">pathwaysAnalysisPathsData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gowtham Rao, Chris Knoll.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

